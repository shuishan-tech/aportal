describe("Creating a map",function(){var o,e,a,t;it("should throw an error if element is not defined",function(){expect(function(){new GMaps({})}).toThrow(new Error("No element defined."))}),describe("With basic options",function(){beforeEach(function(){o=o||new GMaps({el:"#basic-map",lat:-12.0433,lng:-77.0283,zoom:12})}),it("should create a GMaps object",function(){expect(o).toBeDefined()}),it("should have centered the map at the initial coordinates",function(){var e=o.getCenter().lat(),t=o.getCenter().lng();expect(e).toEqual(-12.0433),expect(t).toEqual(-77.0283)}),it("should have the correct zoom",function(){expect(o.getZoom()).toEqual(12)})}),describe("With advanced controls",function(){beforeEach(function(){e=e||new GMaps({el:"#advanced-map",lat:-12.0433,lng:-77.0283,zoomControl:!0,panControl:!1,streetViewControl:!1,mapTypeControl:!1,overviewMapControl:!1})}),it("should show the defined controls",function(){expect(e.map.zoomControl).toBeTruthy(),expect(e.map.panControl).toBeFalsy(),expect(e.map.streetViewControl).toBeFalsy(),expect(e.map.mapTypeControl).toBeFalsy(),expect(e.map.overviewMapControl).toBeFalsy()})}),describe("With events",function(){var o,e=0,n=null;beforeEach(function(){o={onclick:function(e){var t=e.latLng.lat(),e=e.latLng.lng();a.addMarker({lat:t,lng:e,title:"New Marker"})},onzoomchanged:function(){console.log("onzoomchanged"),e=this.getZoom()},oncenterchanged:function(){console.log("oncenterchanged"),n=this.getCenter()}},spyOn(o,"onclick").andCallThrough(),spyOn(o,"onzoomchanged").andCallThrough(),spyOn(o,"oncenterchanged").andCallThrough(),a=a||new GMaps({el:"#map-with-events",lat:-12.0433,lng:-77.0283,click:o.onclick,zoom_changed:o.onzoomchanged,center_changed:o.oncenterchanged})}),it("should respond to zoom_changed event",function(){a.map.setZoom(16),expect(o.onzoomchanged).toHaveBeenCalled(),expect(e).toEqual(16)}),it("should respond to center_changed event",function(){a.map.setCenter(new google.maps.LatLng(-12.0907,-77.0227));var e=parseFloat(n.lat().toFixed(4)),t=parseFloat(n.lng().toFixed(4));expect(o.oncenterchanged).toHaveBeenCalled(),expect(e).toEqual(-12.0907),expect(t).toEqual(-77.0227)}),it("should respond to click event",function(){google.maps.event.trigger(a.map,"click",{latLng:new google.maps.LatLng(-12.0433,-77.0283)}),expect(o.onclick).toHaveBeenCalled(),expect(a.markers.length).toEqual(1)}),afterEach(function(){document.getElementById("map-with-events").innerHTML="",a=null})}),describe("With custom controls",function(){var e;beforeEach(function(){e={onclick:function(){t.addMarker({lat:t.getCenter().lat(),lng:t.getCenter().lng()})}},spyOn(e,"onclick").andCallThrough(),(t=new GMaps({el:"#map-with-custom-controls",lat:-12.0433,lng:-77.0283})).addControl({position:"top_right",content:"Add marker at the center",style:{margin:"5px",padding:"1px 6px",border:"solid 1px #717B87",background:"#fff"},events:{click:e.onclick}})}),it("should add the control to the controls collection",function(){expect(t.controls.length).toEqual(1)}),it("should respond to click event attached to the custom control",function(){google.maps.event.trigger(t.controls[0],"click"),expect(e.onclick).toHaveBeenCalled(),expect(t.markers.length).toEqual(1)})})});