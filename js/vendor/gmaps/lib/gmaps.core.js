var extend_object=function(e,t){var o;if(e===t)return e;for(o in t)void 0!==t[o]&&(e[o]=t[o]);return e},replace_object=function(e,t){var o;if(e===t)return e;for(o in t)null!=e[o]&&(e[o]=t[o]);return e},array_map=function(e,o){var t,n=Array.prototype.slice.call(arguments,2),i=[],s=e.length;if(Array.prototype.map&&e.map===Array.prototype.map)i=Array.prototype.map.call(e,function(e){var t=n.slice(0);return t.splice(0,0,e),o.apply(this,t)});else for(t=0;t<s;t++)callback_params=n,callback_params.splice(0,0,e[t]),i.push(o.apply(this,callback_params));return i},array_flat=function(e){for(var t=[],o=0;o<e.length;o++)t=t.concat(e[o]);return t},coordsToLatLngs=function(e,t){var o=e[0],n=e[1];return t&&(o=e[1],n=e[0]),new google.maps.LatLng(o,n)},arrayToLatLng=function(e,t){for(var o=0;o<e.length;o++)e[o]instanceof google.maps.LatLng||(0<e[o].length&&"object"==typeof e[o][0]?e[o]=arrayToLatLng(e[o],t):e[o]=coordsToLatLngs(e[o],t));return e},getElementsByClassName=function(e,t){var o=e.replace(".",""),n="jQuery"in this&&t?$("."+o,t)[0]:document.getElementsByClassName(o)[0];return n},getElementById=function(e,t){var e=e.replace("#",""),o="jQuery"in window&&t?$("#"+e,t)[0]:document.getElementById(e);return o},findAbsolutePosition=function(e){var t=0,o=0;if(e.offsetParent)for(;t+=e.offsetLeft,o+=e.offsetTop,e=e.offsetParent;);return[t,o]},GMaps=function(){"use strict";var E=document,B=function(o){if("object"!=typeof window.google||!window.google.maps)return"object"==typeof window.console&&window.console.error&&console.error("Google Maps API is required. Please register the following JavaScript library https://maps.googleapis.com/maps/api/js."),function(){};if(!this)return new B(o);o.zoom=o.zoom||15,o.mapType=o.mapType||"roadmap";function e(e,t){return void 0===e?t:e}var t,g=this,n=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],i=["mousemove","mouseout","mouseover"],s=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],a=o.el||o.div,r=o.markerClusterer,l=google.maps.MapTypeId[o.mapType.toUpperCase()],p=new google.maps.LatLng(o.lat,o.lng),m=e(o.zoomControl,!0),c=o.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},h=c.style||"DEFAULT",u=c.position||"TOP_LEFT",d=e(o.panControl,!0),f=e(o.mapTypeControl,!0),y=e(o.scaleControl,!0),v=e(o.streetViewControl,!0),w={},x={zoom:this.zoom,center:p,mapTypeId:l},_={panControl:d,zoomControl:m,zoomControlOptions:{style:google.maps.ZoomControlStyle[h],position:google.maps.ControlPosition[u]},mapTypeControl:f,scaleControl:y,streetViewControl:v,overviewMapControl:!0};if("string"==typeof o.el||"string"==typeof o.div?-1<a.indexOf("#")?this.el=getElementById(a,o.context):this.el=getElementsByClassName.apply(this,[a,o.context]):this.el=a,void 0===this.el||null===this.el)throw"No element defined.";for(window.context_menu=window.context_menu||{},window.context_menu[g.el.id]={},this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=o.zoom,this.registered_events={},this.el.style.width=o.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=o.height||this.el.scrollHeight||this.el.offsetHeight,google.maps.visualRefresh=o.enableNewStyle,t=0;t<s.length;t++)delete o[s[t]];for(1!=o.disableDefaultUI&&(x=extend_object(x,_)),w=extend_object(x,o),t=0;t<n.length;t++)delete w[n[t]];for(t=0;t<i.length;t++)delete w[i[t]];this.map=new google.maps.Map(this.el,w),r&&(this.markerClusterer=r.apply(this,[this.map]));function L(t,o){var e,n="",i=window.context_menu[g.el.id][t];for(var s in i){i.hasOwnProperty(s)&&(e=i[s],n+='<li><a id="'+t+"_"+s+'" href="#">'+e.title+"</a></li>")}if(getElementById("gmaps_context_menu")){var a=getElementById("gmaps_context_menu");a.innerHTML=n;var r=a.getElementsByTagName("a"),l=r.length;for(s=0;s<l;s++){var p=r[s];google.maps.event.clearListeners(p,"click"),google.maps.event.addDomListenerOnce(p,"click",function(e){e.preventDefault(),i[this.id.replace(t+"_","")].action.apply(g,[o]),g.hideContextMenu()},!1)}var m=findAbsolutePosition.apply(this,[g.el]),c=m[0]+o.pixel.x-15,h=m[1]+o.pixel.y-15;a.style.left=c+"px",a.style.top=h+"px"}}this.buildContextMenu=function(o,n){var i;"marker"===o?(n.pixel={},(i=new google.maps.OverlayView).setMap(g.map),i.draw=function(){var e=i.getProjection(),t=n.marker.getPosition();n.pixel=e.fromLatLngToContainerPixel(t),L(o,n)}):L(o,n);var e=getElementById("gmaps_context_menu");setTimeout(function(){e.style.display="block"},0)},this.setContextMenu=function(e){window.context_menu[g.el.id][e.control]={};var t,o,n=E.createElement("ul");for(t in e.options){e.options.hasOwnProperty(t)&&(o=e.options[t],window.context_menu[g.el.id][e.control][o.name]={title:o.title,action:o.action})}n.id="gmaps_context_menu",n.style.display="none",n.style.position="absolute",n.style.minWidth="100px",n.style.background="white",n.style.listStyle="none",n.style.padding="8px",n.style.boxShadow="2px 2px 6px #ccc",getElementById("gmaps_context_menu")||E.body.appendChild(n);var i=getElementById("gmaps_context_menu");google.maps.event.addDomListener(i,"mouseout",function(e){e.relatedTarget&&this.contains(e.relatedTarget)||window.setTimeout(function(){i.style.display="none"},400)},!1)},this.hideContextMenu=function(){var e=getElementById("gmaps_context_menu");e&&(e.style.display="none")};function C(e,t){google.maps.event.addListener(e,t,function(e){null==e&&(e=this),o[t].apply(this,[e]),g.hideContextMenu()})}google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var b=0;b<n.length;b++){(T=n[b])in o&&C(this.map,T)}for(var T,b=0;b<i.length;b++){(T=i[b])in o&&C(this.map,T)}google.maps.event.addListener(this.map,"rightclick",function(e){o.rightclick&&o.rightclick.apply(this,[e]),null!=window.context_menu[g.el.id].map&&g.buildContextMenu("map",e)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){for(var e=[],t=this.markers.length,o=0;o<t;o++)"boolean"==typeof this.markers[o].visible&&this.markers[o].visible&&e.push(this.markers[o].getPosition());this.fitLatLngBounds(e)},this.fitLatLngBounds=function(e){for(var t=e.length,o=new google.maps.LatLngBounds,n=0;n<t;n++)o.extend(e[n]);this.map.fitBounds(o)},this.setCenter=function(e,t,o){this.map.panTo(new google.maps.LatLng(e,t)),o&&o()},this.getElement=function(){return this.el},this.zoomIn=function(e){e=e||1,this.zoom=this.map.getZoom()+e,this.map.setZoom(this.zoom)},this.zoomOut=function(e){e=e||1,this.zoom=this.map.getZoom()-e,this.map.setZoom(this.zoom)};var k,z=[];for(k in this.map)"function"!=typeof this.map[k]||this[k]||z.push(k);for(t=0;t<z.length;t++)!function(e,t,o){e[o]=function(){return t[o].apply(t,arguments)}}(this,this.map,z[t])};return B}();