GMaps.prototype.toImage=function(e){var e=e||{},t={};if(t.size=e.size||[this.el.clientWidth,this.el.clientHeight],t.lat=this.getCenter().lat(),t.lng=this.getCenter().lng(),0<this.markers.length){t.markers=[];for(var r=0;r<this.markers.length;r++)t.markers.push({lat:this.markers[r].getPosition().lat(),lng:this.markers[r].getPosition().lng()})}return 0<this.polylines.length&&(e=this.polylines[0],t.polyline={},t.polyline.path=google.maps.geometry.encoding.encodePath(e.getPath()),t.polyline.strokeColor=e.strokeColor,t.polyline.strokeOpacity=e.strokeOpacity,t.polyline.strokeWeight=e.strokeWeight),GMaps.staticMapURL(t)},GMaps.staticMapURL=function(e){var t=[],r=("file:"===location.protocol?"http:":location.protocol)+"//maps.googleapis.com/maps/api/staticmap";e.url&&(r=e.url,delete e.url),r+="?";var s=e.markers;delete e.markers,!s&&e.marker&&(s=[e.marker],delete e.marker);var o=e.styles;delete e.styles;var l=e.polyline;delete e.polyline,e.center?(t.push("center="+e.center),delete e.center):e.address?(t.push("center="+e.address),delete e.address):e.lat?(t.push(["center=",e.lat,",",e.lng].join("")),delete e.lat,delete e.lng):e.visible&&(i=encodeURI(e.visible.join("|")),t.push("visible="+i));var i=e.size;i?(i.join&&(i=i.join("x")),delete e.size):i="630x300",t.push("size="+i),e.zoom||!1===e.zoom||(e.zoom=15);i=!e.hasOwnProperty("sensor")||!!e.sensor;for(h in delete e.sensor,t.push("sensor="+i),e)e.hasOwnProperty(h)&&t.push(h+"="+e[h]);if(s)for(var a,n,p=0;f=s[p];p++){for(var h in a=[],f.size&&"normal"!==f.size?(a.push("size:"+f.size),delete f.size):f.icon&&(a.push("icon:"+encodeURI(f.icon)),delete f.icon),f.color&&(a.push("color:"+f.color.replace("#","0x")),delete f.color),f.label&&(a.push("label:"+f.label[0].toUpperCase()),delete f.label),n=f.address||f.lat+","+f.lng,delete f.address,delete f.lat,delete f.lng,f)f.hasOwnProperty(h)&&a.push(h+":"+f[h]);a.length||0===p?(a.push(n),a=a.join("|"),t.push("markers="+encodeURI(a))):(a=t.pop()+encodeURI("|"+n),t.push(a))}if(o)for(p=0;p<o.length;p++){var c=[];o[p].featureType&&c.push("feature:"+o[p].featureType.toLowerCase()),o[p].elementType&&c.push("element:"+o[p].elementType.toLowerCase());for(var u=0;u<o[p].stylers.length;u++)for(var d in o[p].stylers[u]){var g=o[p].stylers[u][d];"hue"!=d&&"color"!=d||(g="0x"+g.substring(1)),c.push(d+":"+g)}var m=c.join("|");""!=m&&t.push("style="+m)}function y(e,t){if("#"===e[0]&&(e=e.replace("#","0x"),t)){if(t=parseFloat(t),0===(t=Math.min(1,Math.max(t,0))))return"0x00000000";1===(t=(255*t).toString(16)).length&&(t+=t),e=e.slice(0,8)+t}return e}if(l){var f=l,l=[];f.strokeWeight&&l.push("weight:"+parseInt(f.strokeWeight,10)),f.strokeColor&&(i=y(f.strokeColor,f.strokeOpacity),l.push("color:"+i)),f.fillColor&&(z=y(f.fillColor,f.fillOpacity),l.push("fillcolor:"+z));var k=f.path;if(k.join)for(var v,u=0;v=k[u];u++)l.push(v.join(","));else l.push("enc:"+k);l=l.join("|"),t.push("path="+encodeURI(l))}var z=window.devicePixelRatio||1;return t.push("scale="+z),r+(t=t.join("&"))};