var rulesEngine={};try{if(!jQuery&&module&&module.exports){var jQuery=require("jquery"),jsdom=require("jsdom").jsdom;jQuery=jQuery(jsdom().defaultView)}}catch(r){}!function(m,s){"use strict";var r={};s.forbiddenSequences=["0123456789","abcdefghijklmnopqrstuvwxyz","qwertyuiop","asdfghjkl","zxcvbnm","!@#$%^&*()_+"],r.wordNotEmail=function(r,e,n){return e.match(/^([\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+\.)*[\w\!\#$\%\&\'\*\+\-\/\=\?\^\`{\|\}\~]+@((((([a-z0-9]{1}[a-z0-9\-]{0,62}[a-z0-9]{1})|[a-z])\.)+[a-z]{2,6})|(\d{1,3}\.){3}\d{1,3}(\:\d{1,5})?)$/i)?n:0},r.wordMinLength=function(r,e,n){var t=e.length,o=Math.pow(t,r.rules.raisePower);return t<r.common.minChar&&(o+=n),o},r.wordMaxLength=function(r,e,n){var t=e.length,o=Math.pow(t,r.rules.raisePower);return t>r.common.maxChar?n:o},r.wordInvalidChar=function(r,e,n){return r.common.invalidCharsRegExp.test(e)?n:0},r.wordMinLengthStaticScore=function(r,e,n){return e.length<r.common.minChar?0:n},r.wordMaxLengthStaticScore=function(r,e,n){return e.length>r.common.maxChar?0:n},r.wordSimilarToUsername=function(r,e,n){var t=m(r.common.usernameField).val();return t&&e.toLowerCase().match(t.replace(/[\-\[\]\/\{\}\(\)\*\+\=\?\:\.\\\^\$\|\!\,]/g,"\\$&").toLowerCase())?n:0},r.wordTwoCharacterClasses=function(r,e,n){return e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)||e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)||e.match(/(.[!,@,#,$,%,\^,&,*,?,_,~])/)&&e.match(/[a-zA-Z0-9_]/)?n:0},r.wordRepetitions=function(r,e,n){return e.match(/(.)\1\1/)?n:0},r.wordSequences=function(r,t,e){var o,a=!1;return 2<t.length&&(m.each(s.forbiddenSequences,function(r,e){if(!a){var n=[e,e.split("").reverse().join("")];m.each(n,function(r,e){for(o=0;o<t.length-2;o+=1)-1<e.indexOf(t.toLowerCase().substring(o,o+3))&&(a=!0)})}}),a)?e:0},r.wordLowercase=function(r,e,n){return e.match(/[a-z]/)&&n},r.wordUppercase=function(r,e,n){return e.match(/[A-Z]/)&&n},r.wordOneNumber=function(r,e,n){return e.match(/\d+/)&&n},r.wordThreeNumbers=function(r,e,n){return e.match(/(.*[0-9].*[0-9].*[0-9])/)&&n},r.wordOneSpecialChar=function(r,e,n){return e.match(/[!,@,#,$,%,\^,&,*,?,_,~]/)&&n},r.wordTwoSpecialChar=function(r,e,n){return e.match(/(.*[!,@,#,$,%,\^,&,*,?,_,~].*[!,@,#,$,%,\^,&,*,?,_,~])/)&&n},r.wordUpperLowerCombo=function(r,e,n){return e.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&n},r.wordLetterNumberCombo=function(r,e,n){return e.match(/([a-zA-Z])/)&&e.match(/([0-9])/)&&n},r.wordLetterNumberCharCombo=function(r,e,n){return e.match(/([a-zA-Z0-9].*[!,@,#,$,%,\^,&,*,?,_,~])|([!,@,#,$,%,\^,&,*,?,_,~].*[a-zA-Z0-9])/)&&n},r.wordIsACommonPassword=function(r,e,n){return 0<=m.inArray(e,r.rules.commonPasswords)?n:0},s.validation=r,s.executeRules=function(u,c){var i=0;return m.each(u.rules.activated,function(r,e){if(e){var n,t,o=u.rules.scores[r],a=s.validation[r];m.isFunction(a)||(a=u.rules.extra[r]),m.isFunction(a)&&((n=a(u,c,o))&&(i+=n),(n<0||!m.isNumeric(n)&&!n)&&0<(t=u.ui.spanError(u,r)).length&&u.instances.errors.push(t))}}),i}}(jQuery,rulesEngine);try{module&&module.exports&&(module.exports=rulesEngine)}catch(r){}