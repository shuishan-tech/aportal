define(["./core","./var/document","./var/isFunction","./var/rnothtmlwhite","./ajax/var/location","./ajax/var/nonce","./ajax/var/rquery","./core/init","./ajax/parseXML","./event/trigger","./deferred","./serialize"],function(w,b,s,S,C,H,M){"use strict";var L=/%20/g,R=/#.*$/,D=/([?&])_=[^&]*/,q=/^(.*?):[ \t]*([^\r\n]*)$/gm,E=/^(?:GET|HEAD)$/,F=/^\/\//,O={},N={},$="*/".concat("*"),k=b.createElement("a");function e(n){return function(e,t){"string"!=typeof e&&(t=e,e="*");var a,r=0,o=e.toLowerCase().match(S)||[];if(s(t))for(;a=o[r++];)"+"===a[0]?(a=a.slice(1)||"*",(n[a]=n[a]||[]).unshift(t)):(n[a]=n[a]||[]).push(t)}}function A(t,r,o,n){var s={},i=t===N;function c(e){var a;return s[e]=!0,w.each(t[e]||[],function(e,t){t=t(r,o,n);return"string"!=typeof t||i||s[t]?i?!(a=t):void 0:(r.dataTypes.unshift(t),c(t),!1)}),a}return c(r.dataTypes[0])||!s["*"]&&c("*")}function a(e,t){var a,r,o=w.ajaxSettings.flatOptions||{};for(a in t)void 0!==t[a]&&((o[a]?e:r=r||{})[a]=t[a]);return r&&w.extend(!0,e,r),e}return k.href=C.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:C.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(C.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":$,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?a(a(e,w.ajaxSettings),t):a(w.ajaxSettings,e)},ajaxPrefilter:e(O),ajaxTransport:e(N),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,d,f,a,p,r,u,l,o,h=w.ajaxSetup({},t),x=h.context||h,y=h.context&&(x.nodeType||x.jquery)?w(x):w.event,m=w.Deferred(),g=w.Callbacks("once memory"),v=h.statusCode||{},n={},s={},i="canceled",j={readyState:0,getResponseHeader:function(e){var t;if(u){if(!a)for(a={};t=q.exec(f);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return u?f:null},setRequestHeader:function(e,t){return null==u&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,n[e]=t),this},overrideMimeType:function(e){return null==u&&(h.mimeType=e),this},statusCode:function(e){if(e)if(u)j.always(e[j.status]);else for(var t in e)v[t]=[v[t],e[t]];return this},abort:function(e){e=e||i;return c&&c.abort(e),T(0,e),this}};if(m.promise(j),h.url=((e||h.url||C.href)+"").replace(F,C.protocol+"//"),h.type=t.method||t.type||h.method||h.type,h.dataTypes=(h.dataType||"*").toLowerCase().match(S)||[""],null==h.crossDomain){r=b.createElement("a");try{r.href=h.url,r.href=r.href,h.crossDomain=k.protocol+"//"+k.host!=r.protocol+"//"+r.host}catch(e){h.crossDomain=!0}}if(h.data&&h.processData&&"string"!=typeof h.data&&(h.data=w.param(h.data,h.traditional)),A(O,h,t,j),u)return j;for(o in(l=w.event&&h.global)&&0==w.active++&&w.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!E.test(h.type),d=h.url.replace(R,""),h.hasContent?h.data&&h.processData&&0===(h.contentType||"").indexOf("application/x-www-form-urlencoded")&&(h.data=h.data.replace(L,"+")):(e=h.url.slice(d.length),h.data&&(h.processData||"string"==typeof h.data)&&(d+=(M.test(d)?"&":"?")+h.data,delete h.data),!1===h.cache&&(d=d.replace(D,"$1"),e=(M.test(d)?"&":"?")+"_="+H+++e),h.url=d+e),h.ifModified&&(w.lastModified[d]&&j.setRequestHeader("If-Modified-Since",w.lastModified[d]),w.etag[d]&&j.setRequestHeader("If-None-Match",w.etag[d])),(h.data&&h.hasContent&&!1!==h.contentType||t.contentType)&&j.setRequestHeader("Content-Type",h.contentType),j.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+$+"; q=0.01":""):h.accepts["*"]),h.headers)j.setRequestHeader(o,h.headers[o]);if(h.beforeSend&&(!1===h.beforeSend.call(x,j,h)||u))return j.abort();if(i="abort",g.add(h.complete),j.done(h.success),j.fail(h.error),c=A(N,h,t,j)){if(j.readyState=1,l&&y.trigger("ajaxSend",[j,h]),u)return j;h.async&&0<h.timeout&&(p=window.setTimeout(function(){j.abort("timeout")},h.timeout));try{u=!1,c.send(n,T)}catch(e){if(u)throw e;T(-1,e)}}else T(-1,"No Transport");function T(e,t,a,r){var o,n,s,i=t;u||(u=!0,p&&window.clearTimeout(p),c=void 0,f=r||"",j.readyState=0<e?4:0,r=200<=e&&e<300||304===e,a&&(s=function(e,t,a){for(var r,o,n,s,i=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in i)if(i[o]&&i[o].test(r)){c.unshift(o);break}if(c[0]in a)n=c[0];else{for(o in a){if(!c[0]||e.converters[o+" "+c[0]]){n=o;break}s=s||o}n=n||s}if(n)return n!==c[0]&&c.unshift(n),a[n]}(h,j,a)),s=function(e,t,a,r){var o,n,s,i,c,d={},f=e.dataTypes.slice();if(f[1])for(s in e.converters)d[s.toLowerCase()]=e.converters[s];for(n=f.shift();n;)if(e.responseFields[n]&&(a[e.responseFields[n]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=n,n=f.shift())if("*"===n)n=c;else if("*"!==c&&c!==n){if(!(s=d[c+" "+n]||d["* "+n]))for(o in d)if(i=o.split(" "),i[1]===n&&(s=d[c+" "+i[0]]||d["* "+i[0]])){!0===s?s=d[o]:!0!==d[o]&&(n=i[0],f.unshift(i[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+c+" to "+n}}}return{state:"success",data:t}}(h,s,j,r),r?(h.ifModified&&((a=j.getResponseHeader("Last-Modified"))&&(w.lastModified[d]=a),(a=j.getResponseHeader("etag"))&&(w.etag[d]=a)),204===e||"HEAD"===h.type?i="nocontent":304===e?i="notmodified":(i=s.state,o=s.data,r=!(n=s.error))):(n=i,!e&&i||(i="error",e<0&&(e=0))),j.status=e,j.statusText=(t||i)+"",r?m.resolveWith(x,[o,i,j]):m.rejectWith(x,[j,i,n]),j.statusCode(v),v=void 0,l&&y.trigger(r?"ajaxSuccess":"ajaxError",[j,h,r?o:n]),g.fireWith(x,[j,i]),l&&(y.trigger("ajaxComplete",[j,h]),--w.active||w.event.trigger("ajaxStop")))}return j},getJSON:function(e,t,a){return w.get(e,t,a,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,o){w[o]=function(e,t,a,r){return s(t)&&(r=r||a,a=t,t=void 0),w.ajax(w.extend({url:e,type:o,dataType:r,data:t,success:a},w.isPlainObject(e)&&e))}}),w});