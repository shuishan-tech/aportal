define(["./core","./var/document","./var/isFunction","./var/rnothtmlwhite","./ajax/var/location","./ajax/var/nonce","./ajax/var/rquery","./core/init","./ajax/parseXML","./event/trigger","./deferred","./serialize"],function(b,S,s,C,H,M,L){"use strict";var R=/%20/g,D=/#.*$/,q=/([?&])_=[^&]*/,E=/^(.*?):[ \t]*([^\r\n]*)$/gm,F=/^(?:GET|HEAD)$/,O=/^\/\//,N={},$={},k="*/".concat("*"),A=S.createElement("a");function e(n){return function(e,t){"string"!=typeof e&&(t=e,e="*");var a,r=0,o=e.toLowerCase().match(C)||[];if(s(t))for(;a=o[r++];)"+"===a[0]?(a=a.slice(1)||"*",(n[a]=n[a]||[]).unshift(t)):(n[a]=n[a]||[]).push(t)}}function J(t,o,n,s){var i={},c=t===$;function d(e){var r;return i[e]=!0,b.each(t[e]||[],function(e,t){var a=t(o,n,s);return"string"!=typeof a||c||i[a]?c?!(r=a):void 0:(o.dataTypes.unshift(a),d(a),!1)}),r}return d(o.dataTypes[0])||!i["*"]&&d("*")}function a(e,t){var a,r,o=b.ajaxSettings.flatOptions||{};for(a in t)void 0!==t[a]&&((o[a]?e:r=r||{})[a]=t[a]);return r&&b.extend(!0,e,r),e}return A.href=H.href,b.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:H.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(H.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":k,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":b.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?a(a(e,b.ajaxSettings),t):a(b.ajaxSettings,e)},ajaxPrefilter:e(N),ajaxTransport:e($),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var f,p,u,a,l,r,h,x,o,n,y=b.ajaxSetup({},t),m=y.context||y,g=y.context&&(m.nodeType||m.jquery)?b(m):b.event,v=b.Deferred(),j=b.Callbacks("once memory"),T=y.statusCode||{},s={},i={},c="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(h){if(!a)for(a={};t=E.exec(u);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return h?u:null},setRequestHeader:function(e,t){return null==h&&(e=i[e.toLowerCase()]=i[e.toLowerCase()]||e,s[e]=t),this},overrideMimeType:function(e){return null==h&&(y.mimeType=e),this},statusCode:function(e){if(e)if(h)w.always(e[w.status]);else for(var t in e)T[t]=[T[t],e[t]];return this},abort:function(e){var t=e||c;return f&&f.abort(t),d(0,t),this}};if(v.promise(w),y.url=((e||y.url||H.href)+"").replace(O,H.protocol+"//"),y.type=t.method||t.type||y.method||y.type,y.dataTypes=(y.dataType||"*").toLowerCase().match(C)||[""],null==y.crossDomain){r=S.createElement("a");try{r.href=y.url,r.href=r.href,y.crossDomain=A.protocol+"//"+A.host!=r.protocol+"//"+r.host}catch(e){y.crossDomain=!0}}if(y.data&&y.processData&&"string"!=typeof y.data&&(y.data=b.param(y.data,y.traditional)),J(N,y,t,w),h)return w;for(o in(x=b.event&&y.global)&&0==b.active++&&b.event.trigger("ajaxStart"),y.type=y.type.toUpperCase(),y.hasContent=!F.test(y.type),p=y.url.replace(D,""),y.hasContent?y.data&&y.processData&&0===(y.contentType||"").indexOf("application/x-www-form-urlencoded")&&(y.data=y.data.replace(R,"+")):(n=y.url.slice(p.length),y.data&&(y.processData||"string"==typeof y.data)&&(p+=(L.test(p)?"&":"?")+y.data,delete y.data),!1===y.cache&&(p=p.replace(q,"$1"),n=(L.test(p)?"&":"?")+"_="+M+++n),y.url=p+n),y.ifModified&&(b.lastModified[p]&&w.setRequestHeader("If-Modified-Since",b.lastModified[p]),b.etag[p]&&w.setRequestHeader("If-None-Match",b.etag[p])),(y.data&&y.hasContent&&!1!==y.contentType||t.contentType)&&w.setRequestHeader("Content-Type",y.contentType),w.setRequestHeader("Accept",y.dataTypes[0]&&y.accepts[y.dataTypes[0]]?y.accepts[y.dataTypes[0]]+("*"!==y.dataTypes[0]?", "+k+"; q=0.01":""):y.accepts["*"]),y.headers)w.setRequestHeader(o,y.headers[o]);if(y.beforeSend&&(!1===y.beforeSend.call(m,w,y)||h))return w.abort();if(c="abort",j.add(y.complete),w.done(y.success),w.fail(y.error),f=J($,y,t,w)){if(w.readyState=1,x&&g.trigger("ajaxSend",[w,y]),h)return w;y.async&&0<y.timeout&&(l=window.setTimeout(function(){w.abort("timeout")},y.timeout));try{h=!1,f.send(s,d)}catch(e){if(h)throw e;d(-1,e)}}else d(-1,"No Transport");function d(e,t,a,r){var o,n,s,i,c,d=t;h||(h=!0,l&&window.clearTimeout(l),f=void 0,u=r||"",w.readyState=0<e?4:0,o=200<=e&&e<300||304===e,a&&(i=function(e,t,a){for(var r,o,n,s,i=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(o in i)if(i[o]&&i[o].test(r)){c.unshift(o);break}if(c[0]in a)n=c[0];else{for(o in a){if(!c[0]||e.converters[o+" "+c[0]]){n=o;break}s=s||o}n=n||s}if(n)return n!==c[0]&&c.unshift(n),a[n]}(y,w,a)),i=function(e,t,a,r){var o,n,s,i,c,d={},f=e.dataTypes.slice();if(f[1])for(s in e.converters)d[s.toLowerCase()]=e.converters[s];for(n=f.shift();n;)if(e.responseFields[n]&&(a[e.responseFields[n]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=n,n=f.shift())if("*"===n)n=c;else if("*"!==c&&c!==n){if(!(s=d[c+" "+n]||d["* "+n]))for(o in d)if((i=o.split(" "))[1]===n&&(s=d[c+" "+i[0]]||d["* "+i[0]])){!0===s?s=d[o]:!0!==d[o]&&(n=i[0],f.unshift(i[1]));break}if(!0!==s)if(s&&e.throws)t=s(t);else try{t=s(t)}catch(e){return{state:"parsererror",error:s?e:"No conversion from "+c+" to "+n}}}return{state:"success",data:t}}(y,i,w,o),o?(y.ifModified&&((c=w.getResponseHeader("Last-Modified"))&&(b.lastModified[p]=c),(c=w.getResponseHeader("etag"))&&(b.etag[p]=c)),204===e||"HEAD"===y.type?d="nocontent":304===e?d="notmodified":(d=i.state,n=i.data,o=!(s=i.error))):(s=d,!e&&d||(d="error",e<0&&(e=0))),w.status=e,w.statusText=(t||d)+"",o?v.resolveWith(m,[n,d,w]):v.rejectWith(m,[w,d,s]),w.statusCode(T),T=void 0,x&&g.trigger(o?"ajaxSuccess":"ajaxError",[w,y,o?n:s]),j.fireWith(m,[w,d]),x&&(g.trigger("ajaxComplete",[w,y]),--b.active||b.event.trigger("ajaxStop")))}return w},getJSON:function(e,t,a){return b.get(e,t,a,"json")},getScript:function(e,t){return b.get(e,void 0,t,"script")}}),b.each(["get","post"],function(e,o){b[o]=function(e,t,a,r){return s(t)&&(r=r||a,a=t,t=void 0),b.ajax(b.extend({url:e,type:o,dataType:r,data:t,success:a},b.isPlainObject(e)&&e))}}),b});